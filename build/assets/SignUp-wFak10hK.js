import{r as n,j as e,u as z,d as W,B as R,C as _,l as S,s as w,p as B,b as L,t as Q,S as F}from"./index-DJmUHLA7.js";import{P as A,L as E,I}from"./label-DJUnwysg.js";import{c as V,P as Y,u as Z,a as M,C as ee}from"./index-Csv1_itL.js";import{u as re,a as se}from"./index-BJQMteAk.js";import{S as te}from"./separator-BlQrzGJ6.js";import{A as ae}from"./arrow-left-kjxPTUQP.js";import{L as oe}from"./loader-circle-CU8wI25v.js";var P="Checkbox",[ne]=V(P),[ie,T]=ne(P);function ce(s){const{__scopeCheckbox:o,checked:h,children:i,defaultChecked:u,disabled:t,form:v,name:f,onCheckedChange:x,required:b,value:g="on",internal_do_not_use_render:m}=s,[a,p]=Z({prop:h,defaultProp:u??!1,onChange:x,caller:P}),[c,C]=n.useState(null),[j,l]=n.useState(null),r=n.useRef(!1),d=c?!!v||!!c.closest("form"):!0,k={checked:a,disabled:t,setChecked:p,control:c,setControl:C,name:f,form:v,value:g,hasConsumerStoppedPropagationRef:r,required:b,defaultChecked:y(u)?!1:u,isFormControl:d,bubbleInput:j,setBubbleInput:l};return e.jsx(ie,{scope:o,...k,children:le(m)?m(k):i})}var O="CheckboxTrigger",D=n.forwardRef(({__scopeCheckbox:s,onKeyDown:o,onClick:h,...i},u)=>{const{control:t,value:v,disabled:f,checked:x,required:b,setControl:g,setChecked:m,hasConsumerStoppedPropagationRef:a,isFormControl:p,bubbleInput:c}=T(O,s),C=z(u,g),j=n.useRef(x);return n.useEffect(()=>{const l=t?.form;if(l){const r=()=>m(j.current);return l.addEventListener("reset",r),()=>l.removeEventListener("reset",r)}},[t,m]),e.jsx(A.button,{type:"button",role:"checkbox","aria-checked":y(x)?"mixed":x,"aria-required":b,"data-state":J(x),"data-disabled":f?"":void 0,disabled:f,value:v,...i,ref:C,onKeyDown:M(o,l=>{l.key==="Enter"&&l.preventDefault()}),onClick:M(h,l=>{m(r=>y(r)?!0:!r),c&&p&&(a.current=l.isPropagationStopped(),a.current||l.stopPropagation())})})});D.displayName=O;var G=n.forwardRef((s,o)=>{const{__scopeCheckbox:h,name:i,checked:u,defaultChecked:t,required:v,disabled:f,value:x,onCheckedChange:b,form:g,...m}=s;return e.jsx(ce,{__scopeCheckbox:h,checked:u,defaultChecked:t,disabled:f,required:v,onCheckedChange:b,name:i,form:g,value:x,internal_do_not_use_render:({isFormControl:a})=>e.jsxs(e.Fragment,{children:[e.jsx(D,{...m,ref:o,__scopeCheckbox:h}),a&&e.jsx(U,{__scopeCheckbox:h})]})})});G.displayName=P;var $="CheckboxIndicator",H=n.forwardRef((s,o)=>{const{__scopeCheckbox:h,forceMount:i,...u}=s,t=T($,h);return e.jsx(Y,{present:i||y(t.checked)||t.checked===!0,children:e.jsx(A.span,{"data-state":J(t.checked),"data-disabled":t.disabled?"":void 0,...u,ref:o,style:{pointerEvents:"none",...s.style}})})});H.displayName=$;var q="CheckboxBubbleInput",U=n.forwardRef(({__scopeCheckbox:s,...o},h)=>{const{control:i,hasConsumerStoppedPropagationRef:u,checked:t,defaultChecked:v,required:f,disabled:x,name:b,value:g,form:m,bubbleInput:a,setBubbleInput:p}=T(q,s),c=z(h,p),C=re(t),j=se(i);n.useEffect(()=>{const r=a;if(!r)return;const d=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(d,"checked").set,K=!u.current;if(C!==t&&N){const X=new Event("click",{bubbles:K});r.indeterminate=y(t),N.call(r,y(t)?!1:t),r.dispatchEvent(X)}},[a,C,t,u]);const l=n.useRef(y(t)?!1:t);return e.jsx(A.input,{type:"checkbox","aria-hidden":!0,defaultChecked:v??l.current,required:f,disabled:x,name:b,value:g,form:m,...o,tabIndex:-1,ref:c,style:{...o.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});U.displayName=q;function le(s){return typeof s=="function"}function y(s){return s==="indeterminate"}function J(s){return y(s)?"indeterminate":s?"checked":"unchecked"}function de({className:s,...o}){return e.jsx(G,{"data-slot":"checkbox",className:W("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...o,children:e.jsx(H,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(ee,{className:"size-3.5"})})})}function ge({onNavigate:s}){const[o,h]=n.useState(""),[i,u]=n.useState(""),[t,v]=n.useState(""),[f,x]=n.useState(!1),[b,g]=n.useState(""),[m,a]=n.useState(""),[p,c]=n.useState(!1),C=r=>{if(!r){g("");return}/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?g(""):g("Please enter a valid email address.")},j=r=>{const d=r.target.value;h(d),C(d)},l=async()=>{if(!o||!o.includes("@")){g("Please enter a valid email address.");return}if(!t.trim()){a("Please enter your full name");return}if(i.length<8){a("Password must be at least 8 characters");return}if(!f){a("Please agree to the Terms of Service and Privacy Policy");return}a(""),c(!0),S.cleanup("Clearing storage before signup..."),w.clearAll();try{const r=await fetch(`https://${B}.supabase.co/functions/v1/make-server-cf9a9609/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${L}`},body:JSON.stringify({email:o.toLowerCase().trim(),password:i,fullName:t.trim()})}),d=await r.json();if(!r.ok){r.status===409?a("This email is already registered. Please sign in instead."):r.status===500&&d.error?.includes("Database schema")?(a("⚠️ System setup incomplete. Please contact support."),console.error("CRITICAL: Database schema not deployed!",d)):d.error?.includes("already registered")||d.error?.includes("already exists")||d.error?.includes("email is already registered")?a("This email is already registered. Please sign in instead."):a(d.error||"Failed to create account. Please try again."),c(!1);return}if(!d.success){a("Account creation failed. Please try again."),c(!1);return}try{const k=await fetch(`https://${B}.supabase.co/functions/v1/make-server-cf9a9609/auth/signin`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${L}`},body:JSON.stringify({email:o.toLowerCase().trim(),password:i})}),N=await k.json();k.ok&&N.success&&N.accessToken?(w.setAccessToken(N.accessToken),w.setUserEmail(o.toLowerCase().trim()),w.setUserFullName(t.trim()),Q.success("Welcome to Brand Sense! 🎉",{description:"Let's set up your first brand monitoring project.",duration:4e3}),c(!1),s?.(F.CREATE_PROJECT)):(S.warning("Auto sign-in failed after signup. Please sign in manually."),a("Account created! Please sign in to continue."),c(!1),setTimeout(()=>{s?.(F.SIGN_IN)},2e3))}catch(k){S.error("Auto sign-in error:",k),a("Account created! Please sign in to continue."),c(!1),setTimeout(()=>{s?.("signin")},2e3)}}catch(r){console.error("Sign up error:",r),a("Network error. Please check your connection and try again."),c(!1)}};return e.jsxs("div",{className:"w-full max-w-[400px] mx-auto",children:[e.jsxs("button",{onClick:()=>s?.("landing"),disabled:p,className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-8 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{className:"tracking-tight",children:"Back"})]}),e.jsxs("div",{className:"mb-10",children:[e.jsx("h1",{className:"mb-3 text-foreground tracking-tight",children:"Create Account"}),e.jsx("p",{className:"text-muted-foreground",children:"Start monitoring your brand in ChatGPT"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(R,{variant:"outline",disabled:!0,className:"w-full h-11 bg-card border-border opacity-50 cursor-not-allowed",children:[e.jsxs("svg",{className:"w-5 h-5 mr-3",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google (Not Available)"]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx(te,{className:"bg-border"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"bg-background px-3 text-muted-foreground uppercase tracking-wider",children:"or"})})]}),m&&e.jsxs("div",{className:"mb-4 p-4 border border-destructive/50 rounded-lg bg-destructive/10 flex items-start gap-3",children:[e.jsx(_,{className:"w-5 h-5 text-destructive mt-0.5 shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-destructive",children:m}),m.includes("already registered")&&e.jsx("button",{onClick:()=>s?.("signin"),className:"text-primary hover:text-primary/80 transition-colors mt-2 underline block",children:"Go to Sign In →"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"signup-fullname",className:"text-foreground",children:"Full Name"}),e.jsx(I,{id:"signup-fullname",type:"text",placeholder:"John Doe",value:t,onChange:r=>v(r.target.value),disabled:p,className:"h-11 bg-card border-border focus:border-primary transition-colors"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"signup-email",className:"text-foreground",children:"Email"}),e.jsx(I,{id:"signup-email",type:"email",placeholder:"john@example.com",value:o,onChange:j,disabled:p,className:`h-11 bg-card transition-colors ${b?"border-destructive focus:border-destructive":"border-border focus:border-primary"}`}),b&&e.jsxs("div",{className:"flex items-start gap-2 text-destructive mt-2",children:[e.jsx(_,{className:"w-4 h-4 mt-0.5 shrink-0"}),e.jsx("p",{className:"text-sm",children:b})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"signup-password",className:"text-foreground",children:"Password"}),e.jsx(I,{id:"signup-password",type:"password",placeholder:"At least 8 characters",value:i,onChange:r=>u(r.target.value),disabled:p,className:"h-11 bg-card border-border focus:border-primary transition-colors"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Must be at least 8 characters"})]}),e.jsxs("div",{className:"flex items-start space-x-3 pt-2",children:[e.jsx(de,{id:"gdpr",checked:f,onCheckedChange:r=>x(r===!0),disabled:p,className:"mt-1 border-border"}),e.jsxs("label",{htmlFor:"gdpr",className:"text-muted-foreground cursor-pointer leading-relaxed",children:["I agree to the"," ",e.jsx("button",{className:"text-foreground hover:text-primary transition-colors",children:"Terms of Service"})," ","and"," ",e.jsx("button",{className:"text-foreground hover:text-primary transition-colors",children:"Privacy Policy"})]})]}),e.jsx(R,{onClick:l,disabled:!!b||!o||!t||!i||!f||p,className:"w-full h-11 mt-6 bg-primary hover:bg-primary/90 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:p?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Account..."]}):"Create Account"})]}),e.jsxs("div",{className:"text-center mt-8 pt-6 border-t border-border",children:[e.jsx("span",{className:"text-muted-foreground",children:"Already have an account? "}),e.jsx("button",{onClick:()=>s?.("signin"),className:"text-foreground hover:text-primary transition-colors",children:"Sign In"})]})]})]})}export{ge as SignUp};
