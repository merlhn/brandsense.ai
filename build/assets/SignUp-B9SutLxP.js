import{r as n,j as e,u as z,d as W,B as T,C as _,l as S,s as w,p as B,b as L,t as Q,S as F}from"./index-BFPJ5tGx.js";import{P as A,L as E,I}from"./label-BzbiL-x3.js";import{c as V,P as Y,u as Z,a as M,C as ee}from"./index-DxpQ_VQq.js";import{u as re}from"./index-BDqzhoRP.js";import{S as se}from"./separator-BwazhBuM.js";import{A as te}from"./arrow-left-Bi-CqJAa.js";import{L as ae}from"./loader-circle-sfEqGR4Z.js";function oe(r){const t=n.useRef({value:r,previous:r});return n.useMemo(()=>(t.current.value!==r&&(t.current.previous=t.current.value,t.current.value=r),t.current.previous),[r])}var P="Checkbox",[ne]=V(P),[ie,R]=ne(P);function ce(r){const{__scopeCheckbox:t,checked:h,children:i,defaultChecked:u,disabled:a,form:v,name:f,onCheckedChange:x,required:b,value:g="on",internal_do_not_use_render:m}=r,[o,p]=Z({prop:h,defaultProp:u??!1,onChange:x,caller:P}),[c,C]=n.useState(null),[j,l]=n.useState(null),s=n.useRef(!1),d=c?!!v||!!c.closest("form"):!0,k={checked:o,disabled:a,setChecked:p,control:c,setControl:C,name:f,form:v,value:g,hasConsumerStoppedPropagationRef:s,required:b,defaultChecked:y(u)?!1:u,isFormControl:d,bubbleInput:j,setBubbleInput:l};return e.jsx(ie,{scope:t,...k,children:le(m)?m(k):i})}var O="CheckboxTrigger",D=n.forwardRef(({__scopeCheckbox:r,onKeyDown:t,onClick:h,...i},u)=>{const{control:a,value:v,disabled:f,checked:x,required:b,setControl:g,setChecked:m,hasConsumerStoppedPropagationRef:o,isFormControl:p,bubbleInput:c}=R(O,r),C=z(u,g),j=n.useRef(x);return n.useEffect(()=>{const l=a?.form;if(l){const s=()=>m(j.current);return l.addEventListener("reset",s),()=>l.removeEventListener("reset",s)}},[a,m]),e.jsx(A.button,{type:"button",role:"checkbox","aria-checked":y(x)?"mixed":x,"aria-required":b,"data-state":J(x),"data-disabled":f?"":void 0,disabled:f,value:v,...i,ref:C,onKeyDown:M(t,l=>{l.key==="Enter"&&l.preventDefault()}),onClick:M(h,l=>{m(s=>y(s)?!0:!s),c&&p&&(o.current=l.isPropagationStopped(),o.current||l.stopPropagation())})})});D.displayName=O;var G=n.forwardRef((r,t)=>{const{__scopeCheckbox:h,name:i,checked:u,defaultChecked:a,required:v,disabled:f,value:x,onCheckedChange:b,form:g,...m}=r;return e.jsx(ce,{__scopeCheckbox:h,checked:u,defaultChecked:a,disabled:f,required:v,onCheckedChange:b,name:i,form:g,value:x,internal_do_not_use_render:({isFormControl:o})=>e.jsxs(e.Fragment,{children:[e.jsx(D,{...m,ref:t,__scopeCheckbox:h}),o&&e.jsx(U,{__scopeCheckbox:h})]})})});G.displayName=P;var $="CheckboxIndicator",H=n.forwardRef((r,t)=>{const{__scopeCheckbox:h,forceMount:i,...u}=r,a=R($,h);return e.jsx(Y,{present:i||y(a.checked)||a.checked===!0,children:e.jsx(A.span,{"data-state":J(a.checked),"data-disabled":a.disabled?"":void 0,...u,ref:t,style:{pointerEvents:"none",...r.style}})})});H.displayName=$;var q="CheckboxBubbleInput",U=n.forwardRef(({__scopeCheckbox:r,...t},h)=>{const{control:i,hasConsumerStoppedPropagationRef:u,checked:a,defaultChecked:v,required:f,disabled:x,name:b,value:g,form:m,bubbleInput:o,setBubbleInput:p}=R(q,r),c=z(h,p),C=oe(a),j=re(i);n.useEffect(()=>{const s=o;if(!s)return;const d=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(d,"checked").set,K=!u.current;if(C!==a&&N){const X=new Event("click",{bubbles:K});s.indeterminate=y(a),N.call(s,y(a)?!1:a),s.dispatchEvent(X)}},[o,C,a,u]);const l=n.useRef(y(a)?!1:a);return e.jsx(A.input,{type:"checkbox","aria-hidden":!0,defaultChecked:v??l.current,required:f,disabled:x,name:b,value:g,form:m,...t,tabIndex:-1,ref:c,style:{...t.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});U.displayName=q;function le(r){return typeof r=="function"}function y(r){return r==="indeterminate"}function J(r){return y(r)?"indeterminate":r?"checked":"unchecked"}function de({className:r,...t}){return e.jsx(G,{"data-slot":"checkbox",className:W("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),...t,children:e.jsx(H,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(ee,{className:"size-3.5"})})})}function ge({onNavigate:r}){const[t,h]=n.useState(""),[i,u]=n.useState(""),[a,v]=n.useState(""),[f,x]=n.useState(!1),[b,g]=n.useState(""),[m,o]=n.useState(""),[p,c]=n.useState(!1),C=s=>{if(!s){g("");return}/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?g(""):g("Please enter a valid email address.")},j=s=>{const d=s.target.value;h(d),C(d)},l=async()=>{if(!t||!t.includes("@")){g("Please enter a valid email address.");return}if(!a.trim()){o("Please enter your full name");return}if(i.length<8){o("Password must be at least 8 characters");return}if(!f){o("Please agree to the Terms of Service and Privacy Policy");return}o(""),c(!0),S.cleanup("Clearing storage before signup..."),w.clearAll();try{const s=await fetch(`https://${B}.supabase.co/functions/v1/make-server-cf9a9609/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${L}`},body:JSON.stringify({email:t.toLowerCase().trim(),password:i,fullName:a.trim()})}),d=await s.json();if(!s.ok){s.status===409?o("This email is already registered. Please sign in instead."):s.status===500&&d.error?.includes("Database schema")?(o("âš ï¸ System setup incomplete. Please contact support."),console.error("CRITICAL: Database schema not deployed!",d)):d.error?.includes("already registered")||d.error?.includes("already exists")||d.error?.includes("email is already registered")?o("This email is already registered. Please sign in instead."):o(d.error||"Failed to create account. Please try again."),c(!1);return}if(!d.success){o("Account creation failed. Please try again."),c(!1);return}try{const k=await fetch(`https://${B}.supabase.co/functions/v1/make-server-cf9a9609/auth/signin`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${L}`},body:JSON.stringify({email:t.toLowerCase().trim(),password:i})}),N=await k.json();k.ok&&N.success&&N.accessToken?(w.setAccessToken(N.accessToken),w.setUserEmail(t.toLowerCase().trim()),w.setUserFullName(a.trim()),Q.success("Welcome to Brand Sense! ðŸŽ‰",{description:"Let's set up your first brand monitoring project.",duration:4e3}),c(!1),r?.(F.CREATE_PROJECT)):(S.warning("Auto sign-in failed after signup. Please sign in manually."),o("Account created! Please sign in to continue."),c(!1),setTimeout(()=>{r?.(F.SIGN_IN)},2e3))}catch(k){S.error("Auto sign-in error:",k),o("Account created! Please sign in to continue."),c(!1),setTimeout(()=>{r?.("signin")},2e3)}}catch(s){console.error("Sign up error:",s),o("Network error. Please check your connection and try again."),c(!1)}};return e.jsxs("div",{className:"w-full max-w-[400px] mx-auto",children:[e.jsxs("button",{onClick:()=>r?.("landing"),disabled:p,className:"flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-8 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{className:"tracking-tight",children:"Back"})]}),e.jsxs("div",{className:"mb-10",children:[e.jsx("h1",{className:"mb-3 text-foreground tracking-tight",children:"Create Account"}),e.jsx("p",{className:"text-muted-foreground",children:"Start monitoring your brand in ChatGPT"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(T,{variant:"outline",disabled:!0,className:"w-full h-11 bg-card border-border opacity-50 cursor-not-allowed",children:[e.jsxs("svg",{className:"w-5 h-5 mr-3",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google (Not Available)"]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx(se,{className:"bg-border"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("span",{className:"bg-background px-3 text-muted-foreground uppercase tracking-wider",children:"or"})})]}),m&&e.jsxs("div",{className:"mb-4 p-4 border border-destructive/50 rounded-lg bg-destructive/10 flex items-start gap-3",children:[e.jsx(_,{className:"w-5 h-5 text-destructive mt-0.5 shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-destructive",children:m}),m.includes("already registered")&&e.jsx("button",{onClick:()=>r?.("signin"),className:"text-primary hover:text-primary/80 transition-colors mt-2 underline block",children:"Go to Sign In â†’"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"signup-fullname",className:"text-foreground",children:"Full Name"}),e.jsx(I,{id:"signup-fullname",type:"text",placeholder:"John Doe",value:a,onChange:s=>v(s.target.value),disabled:p,className:"h-11 bg-card border-border focus:border-primary transition-colors"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"signup-email",className:"text-foreground",children:"Email"}),e.jsx(I,{id:"signup-email",type:"email",placeholder:"john@example.com",value:t,onChange:j,disabled:p,className:`h-11 bg-card transition-colors ${b?"border-destructive focus:border-destructive":"border-border focus:border-primary"}`}),b&&e.jsxs("div",{className:"flex items-start gap-2 text-destructive mt-2",children:[e.jsx(_,{className:"w-4 h-4 mt-0.5 shrink-0"}),e.jsx("p",{className:"text-sm",children:b})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"signup-password",className:"text-foreground",children:"Password"}),e.jsx(I,{id:"signup-password",type:"password",placeholder:"At least 8 characters",value:i,onChange:s=>u(s.target.value),disabled:p,className:"h-11 bg-card border-border focus:border-primary transition-colors"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Must be at least 8 characters"})]}),e.jsxs("div",{className:"flex items-start space-x-3 pt-2",children:[e.jsx(de,{id:"gdpr",checked:f,onCheckedChange:s=>x(s===!0),disabled:p,className:"mt-1 border-border"}),e.jsxs("label",{htmlFor:"gdpr",className:"text-muted-foreground cursor-pointer leading-relaxed",children:["I agree to the"," ",e.jsx("button",{className:"text-foreground hover:text-primary transition-colors",children:"Terms of Service"})," ","and"," ",e.jsx("button",{className:"text-foreground hover:text-primary transition-colors",children:"Privacy Policy"})]})]}),e.jsx(T,{onClick:l,disabled:!!b||!t||!a||!i||!f||p,className:"w-full h-11 mt-6 bg-primary hover:bg-primary/90 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:p?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Account..."]}):"Create Account"})]}),e.jsxs("div",{className:"text-center mt-8 pt-6 border-t border-border",children:[e.jsx("span",{className:"text-muted-foreground",children:"Already have an account? "}),e.jsx("button",{onClick:()=>r?.("signin"),className:"text-foreground hover:text-primary transition-colors",children:"Sign In"})]})]})]})}export{ge as SignUp};
